// Generated by CoffeeScript 1.3.3
(function() {

  jQuery(document).ready(function($) {
    var detailView, resultCount, resultList, socket, templates;
    templates = {
      "list-item": _.template($("#list-item-template").html()),
      "detail": _.template($("#detail-template").html())
    };
    resultCount = $("#result-count");
    socket = io.connect("http://localhost:8080");
    resultList = $("ul#results");
    detailView = $("div#detail");
    $("form#search").submit(function(e) {
      resultList.html("");
      detailView.html("");
      socket.emit("search", $("input#query").val());
      return false;
    });
    socket.on("result", function(data) {
      resultCount.text(parseInt(resultCount.text(), 10) + 1);
      return resultList.append(templates["list-item"](data));
    });
    socket.on("detail", function(data) {
      detailView.html(templates["detail"](data));
      return detailView.append(JSON.stringify(data.images));
    });
    return $("li", resultList).live("click", function() {
      socket.emit("view", $(this).data("url"));
      return false;
    });
  });

}).call(this);
